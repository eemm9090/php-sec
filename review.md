# PHP App ② レビュー

## XSS(クロスサイトスクリプティング)

### XSSとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
>ユーザーのアクセス時に表示内容が生成される動的WEBページの脆弱性を利用した攻撃方法。
具体的には、動的WEBページの表示内容を生成処理する際にスクリプトが紛れ込みユーザー環境でスクリプトが実行されてしまう。
攻撃者のメリット：ユーザー環境で実行されるため、cookie情報などの個人情報を盗むことが出来る。

### `htmlspecialchars()`を`e()`として定義しなおすメリットを説明してください。
>コードが簡略化されるので、可読性が高まる。

### `htmlspecialchars()`を使うことでなぜXSSが防げるのか説明してください。
>特殊な文字列に変換されることで、紛れ込んだスクリプトが実行されないようにできるため。

## CSRF(クロスサイトリクエストフォージェリ)

### CSRFとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
>不特定多数の人に対し、意図しないリクエストを送信させる攻撃。
具体的には、公式サイトに似せた偽サイトなどに、ユーザーが誤ってリクエストを送信することで、ユーザーがセッションを持っているサイトに意図しないリクエストを送信させることが出来る。
攻撃者のメリット：ユーザーになりすまして、外部（偽サイト）から意図していないリクエストを送ることが出来る。

### SessionとCookieの違いを説明してください。
> - Session：データを一時的に保存するサーバ側の領域
> - Cookie：データを一時的に保存するブラウザ側の領域

### `setToken()`が何をしているか説明してください。
>`token`というキーにSESSION情報を付随させる。
> - 手順①ランダムな16文字の文字列を生成
> - 手順②手順①で生成した文字列を16進数へ変換
> - 手順③生成された値を`$_SESSION['token']`へ格納

### `checkToken()`が何をしているか説明してください。
> サーバ側とクライアント側の`token`の整合性を確認する。
データが送信されたときに呼び出して確認をし、リクエスト元と一致していない場合は、エラーメッセージの格納とリダイレクトを実行しています。

### トークンを使うことでなぜCSRFが防げるのか説明してください。
>一意なワンタイムトークンを埋め込むことで、リクエスト元が正しいかをチェックできる。
これにより、外部からのリクエストを受け付けないようにする。

## SQLインジェクション

### SQLインジェクションとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
> 想定していないSQL文を実行させる攻撃で、DBのデータを操作することが出来る。
攻撃者のメリット：DBの操作ができる。

### `->prepare()`の返り値と、またこのメソッドが何をしているか説明してください。
>PDOステートメントオブジェクトを返り値とし、プレースホルダをSQL文にセットして、実行する準備をする。

### `->bindValue()`が何をしているか説明してください。
> プレースホルダに値を格納し、データ型を指定する。

### 今回の対策でなぜSQLインジェクションが防げるのか説明してください。
> 変数を直接SQL文に記載せず、プレースホルダを用いてbindValue関数でデータ型を指定することで
入力されたデータは値として処理され、想定していないSQL文を無効化することが出来るため。

## バリデーション

### バリデーションの目的について説明してください。
> 入力されたデータが既定の条件に合っているかを確認することで
ユーザーの不正な入力による不具合発生を防ぐことができる。

### `validate()`が何をしているか説明してください。
> 空欄のタスクが登録できないようにしている。
条件：「定義されてる変数」かつ「入力された値が空欄」の場合は、エラーメッセージの格納とリダイレクトを実行しています。

### `isset($post['content'])`はなぜ必要か、無い場合どうなるか説明してください。
>`isset($post['content'])`があることで、`$post['content']`が未定義の場合でも'validate($post)'の処理ができるようになるため、必要。
>`isset($post['content'])`がない場合は、`$post['content']`が未定義の時（削除するとき）に'validate($post)'のif文で比較対象が無いと判断され、正しく処理できず、エラーになってしまう。

## その他

### `unsetError()`を実行しないとどうなるか説明してください。
> HTMLの<body>タグ上部に記述されているif文でTrueとなり、常にエラーメッセージが表示されてしまう。